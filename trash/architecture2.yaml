architecture:
  version: 0.4
  nodes:
    - !Container
      name: PE
      # spatial: {meshY: 2, meshX: 2}
      # constraints:
      #   temporal: { factors: [ L=16, D=192] }
        # spatial: { factors: [ L=16, D=192] }
        #  spatial: { permutation: [K, N, M] }
        # spatial: { must_iterate_over_dataspaces: [ B ] }
    # - !Nothing { constraints: { temporal: { factors: [ L=16, D=192] } } } # TODO seem to have no effect
    - !Component
      name: Buffer
      class: SRAM
      # constraints:
      #   temporal: { factors: [ L=16, D=192] } # TODO weirdly I get full util with this
      attributes:
        depth: 24*2**16
        width: 128
        datawidth: 8
    - !Component
      name: Accelerator
      spatial: {meshY: 4, meshX: 16}
      # constraints:
        # temporal: { factors: [ L=1, D=1] }
        # spatial: { no_iteration_over_dataspaces: [ B ] }
        # spatial: { permutation: [ N, K, M ] }
      class: intmac
      attributes:
        multiplier_width: 16
        adder_width: 29
